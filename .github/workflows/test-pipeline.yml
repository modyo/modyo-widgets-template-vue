name: Publish to test
on:
  workflow_dispatch:
  push:
    branches:
      - test/centralized-pipeline
jobs:
  install-dependencies:
    uses: modyo/modyo-widgets-template-vue/.github/workflows/install-dependencies.yml@test/centralized-pipeline
    with:
      artifact-name: my-widget
      legacy-peer-deps: true
      build-path: dist/
  build-widget:
    needs: install-dependencies
    uses: modyo/modyo-widgets-template-vue/.github/workflows/build-vue-widget.yml@test/centralized-pipeline
    with:
      artifact-name: my-widget
      legacy-peer-deps: true
      build-path: dist/
  push-to-modyo: 
    needs: build-widget 
    uses: modyo/modyo-widgets-template-vue/.github/workflows/push-to-modyo.yml@test/centralized-pipeline
    with:
      environment: develop # Set env vars in dev env
      artifact-name: my-widget
    secrets:
      modyo-token: ${{ secrets.TOKEN }}
 